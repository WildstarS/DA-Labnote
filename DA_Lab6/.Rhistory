knitr::opts_chunk$set(echo = TRUE)
library('tidyverse')
library(mdsr)
library(olsrr)
df_exs <- HELPrct %>%
select(id, cesd, age, female, avg_drinks, dayslink, drugrisk, mcs, pcs, pss_fr, racegrp, treat)
HELPrct
?mdsr
library(mdsr)
mdsr
?mdsr
??mdsr
?HELPrct
HELPrct
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(mdsr)
library(olsrr)
df_exs <- HELPrct %>%
select(id, cesd, age, female, avg_drinks, dayslink, drugrisk, mcs, pcs, pss_fr, racegrp, treat)
df_exs <- data(HELPrct) %>%
select(id, cesd, age, female, avg_drinks, dayslink, drugrisk, mcs, pcs, pss_fr, racegrp, treat)
HELPrct
?HELPrct
library(tidyverse)
library(mdsr)
library(olsrr)
df_exs <- HELPrct %>%
select(id, cesd, age, female, avg_drinks, dayslink, drugrisk, mcs, pcs, pss_fr, racegrp, treat)
df_exs <- HELPrct %>%
select(id, cesd, age, female, avg_drinks, dayslink, drugrisk, mcs, pcs, pss_fr, racegrp, treat)
data(HELPrct)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(mdsr)
library(olsrr)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(mdsr)
library(olsrr)
df_exs <- HELPrct %>%
select(id, cesd, age, female, avg_drinks, dayslink, drugrisk, mcs, pcs, pss_fr, racegrp, treat)
install.packages('olsrr')
install.packages("olsrr")
library(mosaicData)
df_exs <- HELPrct %>%
select(id, cesd, age, female, avg_drinks, dayslink, drugrisk, mcs, pcs, pss_fr, racegrp, treat)
libaray(modaicdata)
library(modaicdata)
library(modaicdata)#to load HELPrct
library(mosaicdata)#to load HELPrct
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(mdsr)
library(olsrr)
library(mosaicData)#to load HELPrct
df_exs <- HELPrct %>%
select(id, cesd, age, female, avg_drinks, dayslink, drugrisk, mcs, pcs, pss_fr, racegrp, treat)
levels(df_exs$racegrp)
levels(df_exs$treat)
exs_one_hot <- model.matrix(~0+df_exs$racegrp)
df_temp <- df_exs %>%
cbind(exs_one_hot) %>%
mutate(istreat = ifelse(treat == 'yes', 1, 0)) %>%
rename('isBlack' = 'df_exs$racegrpblack', 'isHisph' = 'df_exs$racegrphispanic', 'isOther' = 'df_exs$racegrpother', 'isWhite' = 'df_exs$racegrpwhite') %>%
select(-racegrp, -treat)
sum(is.na(df_temp$dayslink))
sum(is.na(df_temp$drugrisk))
temp_mean <- mean(df_temp$dayslink, na.rm = TRUE)
temp_mean2 <- mean(df_temp$drugrisk, na.rm = TRUE)
df_exs2 <- df_temp %>%
mutate(dayslink = ifelse(is.na(dayslink), temp_mean, dayslink), drugrisk = ifelse(is.na(drugrisk), temp_mean2, drugrisk))
sum(is.na(df_exs2$dayslink))
sum(is.na(df_exs2$drugrisk))
model_q3 <- lm(cesd ~ ., data = df_exs2 %>% select(-id, -isOther))
summary(model_q3)
m_both <- ols_step_both_aic(model_q3)
m_both$predictors
m_for <- ols_step_forward_aic(model_q3)
m_for$predictors
m_back <- ols_step_backward_aic(model_q3)
m_back$predictors
?HELPrct
plot(m_both, which = 1)
plot(m_both, which = 2)
plot(m_both, which = 3)
View(m_both)
plot(m_both, which = 1)
plot(m_both, which = 2)
plot(m_both, which = 15)
plot(m_both)
model_q3 <- lm(cesd ~ m_both$predictors, data = df_exs2)
m_both <- ols_step_both_aic(model_q3)
model_q3 <- lm(cesd ~ mcs + pcs + avg_drinks + female + pss_fr + isBlack, data = df_exs2)
model_q4 <- lm(cesd ~ mcs + pcs + avg_drinks + female + pss_fr + isBlack, data = df_exs2)
model_q3 <- lm(cesd ~ ., data = df_exs2 %>% select(-id, -isOther))
summary(model_q3)
m_both <- ols_step_both_aic(model_q3)
model_q4 <- lm(cesd ~ mcs + pcs + avg_drinks + female + pss_fr + isBlack, data = df_exs2)
plot(model_q4, which = 1)
plot(model_q4, which = 2)
library(lmtest)
install.packages(lmtest)
install.packages('lmtest')
library(lmtest)
dwtest(cesd ~ mcs + pcs + avg_drinks + female + pss_fr + isBlack, data = df_exs2, alternative = "two_sided")
dwtest(cesd ~ mcs + pcs + avg_drinks + female + pss_fr + isBlack, data = df_exs2, alternative = "two.sided")
model_q6 <- lm(cesd ~ mcs + pcs, data = df_exs2)
summary(model_q6)
model_q6a <- lm(cesd ~ mcs + pcs, data = df_exs2)
model_q6b <- lm(cesd ~ mcs + pcs + mcs*pcs, data = df_exs2)
summary(model_q6a)
summary(model_q6b)
model_q6b <- lm(cesd ~ mcs + pcs + mcs*pcs, data = df_exs2)
summary(model_q6a)
summary(model_q6b)
model_q6a <- lm(cesd ~ mcs + pcs, data = df_exs2)
model_q6b <- lm(cesd ~ mcs + pcs + mcs*pcs, data = df_exs2)
summary(model_q6a)
summary(model_q6b)
model_q7 <- lm(cesd ~ mcs, data = df_exs2)
summary(model_q7)
?lm
model_q6a <- lm(cesd ~ mcs + pcs, data = df_exs2)
model_q6b <- lm(cesd ~ mcs*pcs, data = df_exs2)
summary(model_q6a)
summary(model_q6b)
model_q7 <- lm(cesd ~ mcs, data = df_exs2)
summary(model_q7)
install.packages('glmnet')
library(glmnet)
glmnet(mcs, cesd)
glmnet(mcs, cesd, data = df_exs2)
glmnet(mcs, cesd, data = df_exs2)
glmnet(df_exs2$mcs, df_exs2$cesd)
